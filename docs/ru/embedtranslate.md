# Встроенный перевод

## Способ использования

::: danger
Во-первых, не все игры поддерживают встроенный перевод. Во-вторых, встроенный перевод может привести к сбоям в игре.
:::

::: details Если в выбранном тексте нет строки о встроенном переводе, значит он не поддерживается 
![img](https://image.lunatranslator.org/zh/embed/noembed.png) 
![img](https://image.lunatranslator.org/zh/embed/someembed.png) 
:::

Для игр, поддерживающих встроенный перевод, выберите поддерживаемые текстовые элементы и активируйте встроенный перевод.

![img](https://image.lunatranslator.org/zh/embed/select.png)

Для поддерживаемых элементов можно свободно выбирать, активировать ли одновременно **отображение** и **встроенный перевод**. При одновременной активации перевод будет встроен в игру и дополнительно отображен в окне программы; если активирован только встроенный перевод, текст будет виден только в игре, а окно программы останется пустым.

После начала встроенного перевода часто возникают проблемы с кодировкой. Обычно это связано с **кодировкой символов** или **шрифтами**. Для английских игр проблема обычно в отсутствии **шрифтов**, поддерживающих китайские символы, например:

![img](https://image.lunatranslator.org/zh/embed/luanma.png)

В этом случае необходимо активировать **изменение игрового шрифта** и выбрать подходящий шрифт для отображения китайских символов.

![img](https://image.lunatranslator.org/zh/embed/ziti.png)

После смены шрифта китайские символы будут отображаться корректно:

![img](https://image.lunatranslator.org/zh/embed/okembed.png)

Для многих старых японских galgame, использующих встроенную кодировку shift-jis, которая не поддерживает китайские символы, можно попробовать **конвертировать иероглифы в традиционные/японские варианты**, чтобы уменьшить количество ошибок отображения.

Для более новых игровых движков и большинства англоязычных игр обычно используются Unicode-кодировки, такие как utf-8 или utf-16 (например, **KiriKiri**, **Renpy**, **TyranoScript**, **RPGMakerMV**). Если возникает проблема с отображением символов, это обычно связано со шрифтами, а не с кодировкой.

![img](https://image.lunatranslator.org/zh/embed/fanti.png)

После отключения этой настройки упрощённый китайский стал отображаться нормально. Однако для некоторых игр, где упрощённый китайский отображается некорректно, можно попробовать активировать эту опцию, чтобы проверить, решит ли это проблему.

![img](https://image.lunatranslator.org/zh/embed/good.png)

## Настройки встроенного перевода

1. #### Режим отображения

    ![img](https://image.lunatranslator.org/zh/embed/keeporigin.png)

    Из-за ограничений на количество строк текста, которое может отображаться в игре, по умолчанию перевод и оригинальный текст не разделяются переносом строки. Если вы уверены, что игра поддерживает больше строк, можно добавить регулярное выражение в разделе **Оптимизация перевода** -> **Коррекция перевода**, чтобы добавить перенос строки перед переводом.

    ![img](https://image.lunatranslator.org/zh/embed/addspace.png)

1. #### Время ожидания перевода

    Принцип встроенного перевода заключается в том, что перед отображением текста в игре игра приостанавливается в определённой функции, текст отправляется переводчику, и после получения перевода память игры изменяется для отображения переведённого текста, после чего игра продолжает работу. Поэтому **если используемый переводчик работает медленно, это неизбежно вызовет задержки в игре**. Чтобы избежать длительных задержек из-за медленного перевода, можно ограничить максимальное время ожидания.

1. #### Преобразование китайских иероглифов в традиционные/японские

    Пропущено

1. #### Ограничение количества символов в строке

    Иногда в некоторых играх количество символов, отображаемых в строке, ограничено, и содержимое, превышающее длину строки, будет отображаться за пределами текстового поля справа и не будет видно. Эту настройку можно использовать для ручного разделения строк, чтобы избежать этой ситуации.

    ![img](https://image.lunatranslator.org/zh/embed/limitlength.png)

1. #### Изменение игрового шрифта

    Пропущено

1. #### Встроенная проверка безопасности

    Для таких игр, как Renpy, извлечённый текст часто включает символы синтаксических элементов, такие как `{` `}` `[` `]`. Если источник перевода не обрабатывает эти элементы корректно, что приводит к нарушению синтаксиса, это может вызвать сбой игры. Поэтому по умолчанию программа использует регулярные выражения для **пропуска перевода** некоторых комбинаций символов, которые могут вызвать проблемы в игре. Если вас не беспокоит возможность сбоя игры, вы можете отключить эту настройку или вручную заменить её более детализированными регулярными выражениями, чтобы уменьшить количество ненужных пропусков.

    ![img](https://image.lunatranslator.org/zh/embed/safeskip.png)

1. #### Очистка текста, отображаемого в игре

    При активации этой опции содержимое в местах, где должен отображаться встроенный текст, будет очищено.

    Эта опция может быть полезна в следующих случаях:

    1. Иногда возникают нерешаемые проблемы с кодировкой символов или отображением шрифтов во встроенном переводе. Включив эту опцию и наложив окно программы на область, где в игре отображается текст, можно имитировать встроенный перевод.

    1. Иногда мы не хотим использовать встроенный перевод, а при использовании внешнего перевода может возникнуть ощущение, что размещение окна в текстовой области приведёт к наложению на исходный текст, а размещение в другом месте загородит изображение.

    1. Иногда мы просто хотим изучать японский язык, но в игровых текстах нет функции добавления фонетической разметки или двуязычного сравнения.
